[package]
name = "forge3d"
version = "0.9.0"
edition = "2021"

[lib]
name = "forge3d"
crate-type = ["cdylib", "lib"]

# A2-BEGIN:cargo-features
[features]
default = ["extension-module"]
extension-module = ["pyo3/extension-module"]
# Optional async/double-buffered readback (R9)
async_readback = ["dep:tokio"]
terrain_spike = []
weighted-oit = []
wsI_bigbuf = []
wsI_double_buf = []
# Quiet cfg warnings in formats when unused
exr = []
# Workstream N: Advanced Rendering Systems
enable-pbr = []
enable-ibl = []
enable-csm = []
enable-tbn = []
enable-normal-mapping = ["enable-tbn"]
enable-hdr-offscreen = []
enable-render-bundles = []
# Workstream O: Resource & Memory Management
enable-memory-pools = []
enable-staging-rings = []
# A2-END:cargo-features

[dependencies]
pyo3  = { version = "0.21.2", features = ["extension-module", "abi3-py38"] }
numpy = "0.21"
ndarray = "0.15"
wgpu = "0.19"
pollster = "0.3"
bytemuck = { version = "1", features = ["derive"] }
image = { version = "0.25", default-features = false, features = ["png"] }
glam = "0.24"
thiserror = "1"
once_cell = "1"
half = "2.3"
lyon_tessellation = "1.0"
lyon_path = "1.0"
tokio = { version = "1", features = ["macros", "rt", "rt-multi-thread"], optional = true }
env_logger = "0.10"

[dev-dependencies]
tokio = { version = "1", features = ["macros", "rt", "rt-multi-thread"] }
env_logger = "0.10"

[[example]]
name = "split_vs_single_bg"
path = "examples/perf/split_vs_single_bg.rs"

[[bin]]
name = "policies"
path = "bench/upload_policies/policies.rs"

[profile.release]
codegen-units = 1
lto = "thin"

# Optimized profile for Python wheel builds
[profile.release-lto]
inherits = "release"
lto = "fat"
codegen-units = 1
panic = "abort"
strip = "symbols"

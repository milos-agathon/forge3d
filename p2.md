# P2 — BRDF library + material routing (switchable shading models)

**Goal:** Implement BRDFs and a clean switch to choose model per-material or global.

**WGSL**

* New `brdf/` module:

  * `common.wgsl`: geometry terms (Smith GGX/Beckmann), Schlick Fresnel, VNDF sampling hooks, Trowbridge-Reitz GGX, Oren–Nayar.
  * `lambert.wgsl`, `phong.wgsl`, `oren_nayar.wgsl`, `cook_torrance.wgsl`, `disney_principled.wgsl`, `ashikhmin_shirley.wgsl`, `ward.wgsl`, `toon.wgsl`, `minnaert.wgsl`.
  * `dispatch.wgsl` exposes:

    ```wgsl
    struct ShadingParamsGPU { brdf_model: u32; metallic: f32; roughness: f32; sheen: f32; clearcoat: f32; subsurface: f32; anisotropy: f32; }
    @group(0) @binding(5) var<uniform> shading: ShadingParamsGPU;

    fn eval_brdf(n: vec3<f32>, v: vec3<f32>, l: vec3<f32>, base_color: vec3<f32>, params: ShadingParamsGPU) -> vec3<f32> {
      switch (params.brdf_model) {
        case 0u: return lambert(n, l, base_color);
        case 1u: return phong(n, v, l, base_color, /* shininess from roughness */);
        case 2u: return oren_nayar(...);
        case 3u: return cook_torrance_ggx(...);
        case 4u: return cook_torrance_beckmann(...);
        case 5u: return disney_principled(...);
        case 6u: return ashikhmin_shirley(...);
        case 7u: return ward(...);
        case 8u: return toon(...);
        case 9u: return minnaert(...);
        default: return lambert(n, l, base_color);
      }
    }
    ```
* Normal mapping, roughness/metallic, anisotropy tangents (support if available).

**Backend**

* Extend material UBO/SSBO to include `ShadingParamsGPU`.
* Global override via `RendererConfig.brdf_override: Option<BrdfModel>`.

**Acceptance**

* Golden images: same scene rendered with Lambert vs GGX vs Disney shows distinct lobes.
* Shader compiles across win_amd64, linux_x86_64, macos_universal2.

---

